[TOC]

# 0. 背景知识

询问chatgpt支持向量机相关知识：

![image-20240521161056966](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521161056966.png)

# 1. 导入包

```python
# 导入包
import numpy as np
import pandas as pd
```

# 2. 导入数据集

```python
# 导入数据集
data = pd.read_csv('/home/dataset/BlackFriday.csv')
data.head()
```

![image-20240521161342601](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521161342601.png)

# 3. 数据预处理

## 3.1 检测并处理缺失值

```python
# 检测缺失值
null_df = data.isnull().sum()
null_df
```

![image-20240521161522983](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521161522983.png)

```python
# 删除缺失列
data = data.drop(['Product_Category_2', 'Product_Category_3'], axis = 1)
data.head()
```

![image-20240521161559173](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521161559173.png)

```python
# 再次检测缺失值
null_df = data.isnull().sum()
null_df
```

![image-20240521161633718](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521161633718.png)

## 3.2 删除无用的列

```python
# 删除无用的列
data = data.drop(['User_ID', 'Product_ID'], axis = 1)
```

## 3.3 检查类别型变量

```python
# 检查类别型变量
print(data.dtypes)
```

![image-20240521161918687](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521161918687.png)

```python
# 转换变量类型
data['Stay_In_Current_City_Years'].replace('4+', 4, inplace = True)
data['Stay_In_Current_City_Years'] = data['Stay_In_Current_City_Years'].astype('int64')
data['Product_Category_1'] = data['Product_Category_1'].astype('object')
data['Occupation'] = data['Occupation'].astype('object')
data['Marital_Status'] = data['Marital_Status'].astype('object')
```



```python
# 检查类别型变量
print(data.dtypes)
```

![image-20240521162041900](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521162041900.png)

## 3.4 标签编码和独热编码

![image-20240521162448242](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521162448242.png)

```python
# 标签编码&独热编码
data = pd.get_dummies(data, drop_first = True)
data.head()
```



![image-20240521162512259](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521162512259.png)

## 3.5 得到自变量和因变量

```python
# 得到自变量和因变量
y = data['Purchase'].values
data = data.drop(['Purchase'], axis = 1)
x = data.values
```

## 3.6 拆分训练集和测试集

```python
# 拆分训练集和测试集
from sklearn.model_selection import train_test_split
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.3, random_state = 1)

print(x_test.shape)
print(y_test.shape)
print(x_train.shape)
print(y_train.shape)

```

![image-20240521162714475](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521162714475.png)

## 3.7 特征缩放

```python
# 特征缩放
from sklearn.preprocessing import StandardScaler
sc_x = StandardScaler()
x_train = sc_x.fit_transform(x_train)
x_test = sc_x.transform(x_test)
sc_y = StandardScaler()
y_train = np.ravel(sc_y.fit_transform(y_train.reshape(-1, 1)))
```

# 4. 使用不同的参数构建支持向量机模型

## 4.1 模型1

### 4.1.1 构建模型

```python
# 使用不同的参数构建支持向量机模型
# 模型1
from sklearn.svm import SVR
regressor = SVR(kernel = 'rbf', gamma='scale', C=1.0, epsilon=0.1, verbose=True)
regressor.fit(x_train, y_train)
```

![image-20240521163721612](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521163721612.png)

### 4.1.2 测试集做预测

```python
# 在测试集做预测
y_pred = regressor.predict(x_test)
y_pred[:5]
```

![image-20240521163610836](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521163610836.png)

```python
# y_pred变回特征缩放之前的
y_pred = sc_y.inverse_transform(y_pred)
y_pred[:5]
```

![image-20240521163629827](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521163629827.png)

### 4.1.3 评估模型性能

```python
# 评估模型性能
from sklearn.metrics import r2_score
r2 = r2_score(y_test, y_pred)
print("R2 Score:", r2)
```

![image-20240521163650420](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521163650420.png)

## 4.2 模型2

```python
# 模型2
regressor = SVR(kernel = 'rbf', gamma='scale', C=10, epsilon=0.1, verbose=True)
regressor.fit(x_train, y_train)
# 在测试集做预测
y_pred = regressor.predict(x_test)
# y_pred变回特征缩放之前的
y_pred = sc_y.inverse_transform(y_pred)
# 评估模型性能
r2 = r2_score(y_test, y_pred)
print("R2 Score:", r2)
```

![image-20240521163902278](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521163902278.png)

## 4.3 模型3

```python
# 模型3
regressor = SVR(kernel = 'poly', degree=3, gamma='scale', C=1.0, epsilon=0.1, verbose=True)
regressor.fit(x_train, y_train)
# 在测试集做预测
y_pred = regressor.predict(x_test)
# y_pred变回特征缩放之前的
y_pred = sc_y.inverse_transform(y_pred)
# 评估模型性能
r2 = r2_score(y_test, y_pred)
print("R2 Score:", r2)
```



![image-20240521163940097](C:\Users\gorsonpy\AppData\Roaming\Typora\typora-user-images\image-20240521163940097.png)

# 5. 实验结论

#### 1. 支持向量机可以解决回归问题

在本实验中，我们探讨了支持向量机（SVM）在回归任务中的应用，验证了其有效性。SVM不仅可以用于分类任务，还可以通过扩展成支持向量回归（SVR）来解决回归问题。

- **支持向量回归（SVR）**：SVR通过在高维空间中寻找一个回归超平面，使得大多数训练样本位于超平面附近的带状区域内，从而实现回归预测。实验结果表明，SVR在处理复杂的非线性回归问题时表现出色，具有较高的预测精度。
- **ε-不敏感带**：SVR引入了ε-不敏感带，允许一定范围内的预测误差，避免了过拟合现象。通过调整ε参数，我们可以控制模型的复杂度和平滑度，从而在偏差与方差之间取得平衡。

#### 2. 不同超参数对模型性能的影响不同

在SVM模型中，超参数的选择对模型性能具有显著影响。通过一系列实验，我们总结了以下几点结论：

- **核函数的选择**：
  - **线性核**：适用于线性可分的数据集，计算速度快，但在处理非线性数据时表现不佳。
  - **多项式核**：能够捕捉特征之间的高阶关系，但计算复杂度较高。实验表明，多项式核在处理某些复杂的非线性数据时具有优势。
  - **高斯核（RBF核）**：常用于非线性分类任务，能够将数据映射到高维空间，使得复杂的非线性关系在高维空间中线性可分。实验结果显示，高斯核在大多数情况下具有优越的分类性能。
- **正则化参数C**：
  - **C值的影响**：C值控制分类器的惩罚项，平衡训练误差和模型复杂度。较小的C值会产生一个平滑的决策边界，但可能增加训练误差；较大的C值会尽量减少训练误差，但可能导致过拟合。实验表明，通过调整C值，可以有效控制模型的偏差与方差。
- **核参数γ（对于RBF核）**：
  - **γ值的影响**：γ值决定了高斯核的作用范围，较大的γ值意味着更小的作用范围，模型会更关注于局部特征，可能导致过拟合；较小的γ值则关注于全局特征，可能导致欠拟合。实验结果显示，γ值的选择对模型性能有显著影响，需要通过交叉验证等方法进行调优。

### 结论总结

通过一系列实验，我们验证了支持向量机在分类和回归任务中的有效性，并详细分析了不同超参数对模型性能的影响。支持向量机通过选择合适的核函数和超参数，能够在复杂的非线性数据中找到最佳决策边界，实现高精度的分类和回归预测。

这些实验结果为我们在应用SVM模型时提供了重要的指导，通过合理选择核函数和调节超参数，可以显著提升模型的性能，适应不同的应用场景，达到最佳效果。